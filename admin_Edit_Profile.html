<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Admin Profile · BookTrack</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link href="assets/css/styles.css" rel="stylesheet">
</head>
<body class="bt-theme d-flex flex-column min-vh-100">

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <div class="container">
            <a class="bt-brand navbar-brand" href="index.html">
                <span class="bt-brand-mark">B</span>
                <span>BookTrack</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="admin_Dasboard.html">Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin_User_List.html">Users</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin_Book_List.html">Books</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin_Logs.html">Logs</a></li>
                    <li class="nav-item"><a class="nav-link active" href="admin_Profile.html">Profile</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin_Settings.html">Settings</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" id="logoutBtn">Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="flex-grow-1 d-flex align-items-center justify-content-center">
        <div class="w-100" style="max-width:500px;">
            <div class="bt-card p-4 p-md-5">
                <div class="text-center mb-4">
                    <img src="assets/img/profile-placeholder.png" alt="Admin Profile Picture" class="rounded-circle border mb-2" style="width: 96px; height: 96px; object-fit: cover;">
                    <div>
                        <button class="btn btn-sm btn-bt mt-2" type="button">Change Photo</button>
                    </div>
                </div>
                <h4 class="bt-title text-center mb-3">Edit Admin Profile</h4>
                <form id="adminProfileForm">
                    <div class="row g-3">
                        <div class="col-6">
                            <label for="firstName" class="form-label">First name</label>
                            <input type="text" class="form-control bt-input" id="firstName" placeholder="Admin" required>
                        </div>
                        <div class="col-6">
                            <label for="lastName" class="form-label">Last name</label>
                            <input type="text" class="form-control bt-input" id="lastName" placeholder="User" required>
                        </div>
                        <div class="col-12">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control bt-input" id="email" placeholder="admin@booktrack.com" required>
                        </div>
                        <div class="col-12">
                            <label for="phone" class="form-label">Phone</label>
                            <input type="tel" class="form-control bt-input" id="phone" placeholder="+1-555-0125">
                        </div>
                        <div class="col-12">
                            <label for="department" class="form-label">Department</label>
                            <input type="text" class="form-control bt-input" id="department" placeholder="System Administration">
                        </div>
                        <div class="col-12">
                            <label for="bio" class="form-label">Bio</label>
                            <textarea class="form-control bt-input" id="bio" rows="3" placeholder="Brief description about your role..."></textarea>
                        </div>
                    </div>
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-bt">Save Changes</button>
                        <a href="admin_View_Profile.html" class="btn btn-outline-secondary">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-auto py-4 border-top text-center bt-muted">
        <div class="container">
            <p class="mb-1">&copy; 2025 BookTrack. All rights reserved.</p>
            <small>Made with ❤️ using Bootstrap 5</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous"></script>

    <script>
        // Check if admin is logged in
        function checkAuth() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            const userRole = sessionStorage.getItem('userRole');
            
            if (!isLoggedIn || userRole !== 'admin') {
                window.location.href = 'login.html';
                return;
            }
            
            // Load admin profile data
            loadAdminProfile();
        }

        // Load admin profile data
        function loadAdminProfile() {
            const adminData = JSON.parse(localStorage.getItem('adminProfile')) || {
                firstName: 'Admin',
                lastName: 'User',
                email: 'admin@booktrack.com',
                phone: '+1-555-0125',
                department: 'System Administration',
                bio: 'System administrator responsible for managing the BookTrack platform, user accounts, and system maintenance.'
            };

            document.getElementById('firstName').value = adminData.firstName;
            document.getElementById('lastName').value = adminData.lastName;
            document.getElementById('email').value = adminData.email;
            document.getElementById('phone').value = adminData.phone;
            document.getElementById('department').value = adminData.department;
            document.getElementById('bio').value = adminData.bio;
        }

        // Save admin profile
        function saveAdminProfile(event) {
            event.preventDefault();

            const adminData = {
                firstName: document.getElementById('firstName').value.trim(),
                lastName: document.getElementById('lastName').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                department: document.getElementById('department').value.trim(),
                bio: document.getElementById('bio').value.trim(),
                joinDate: JSON.parse(localStorage.getItem('adminProfile'))?.joinDate || '2024-01-01',
                lastActive: new Date().toLocaleDateString()
            };

            localStorage.setItem('adminProfile', JSON.stringify(adminData));
            showAlert('Profile updated successfully!', 'success');
            
            // Redirect to view profile after a short delay
            setTimeout(() => {
                window.location.href = 'admin_View_Profile.html';
            }, 1500);
        }

        // Logout function
        function logout() {
            sessionStorage.clear();
            window.location.href = 'login.html';
        }

        // Show alert
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // Event listeners
        document.getElementById('adminProfileForm').addEventListener('submit', saveAdminProfile);
        document.getElementById('logoutBtn').addEventListener('click', logout);

        checkAuth();
    </script>
</body>
</html>
